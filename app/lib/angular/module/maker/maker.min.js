angular.module("MakerJS",[]).controller("ShapeCtrl",["$scope",function(){}]).directive("makeShapeSide",function(){return{restrict:"E",scope:{shape:"=shape",controls:"=controls",index:"=index"},transclude:!0,replace:!0,template:"<div class = 'side' ng-style = 'style'></div>",controller:function(a,b,c){a.$watch("controls.width",function(){d()}),a.$watch("controls.height",function(){d()}),a.$watch("controls.depth",function(){d()});var d=function(){var b={width:"100%",height:"100%",left:"auto",top:"auto",bottom:"0",background:"#"+a.controls.color,rotateX:0,rotateY:0,rotateZ:0,translateX:0,translateY:0,translateZ:0};switch(a.controls.type){case"r":switch(a.index){case 0:b.width=a.controls.width+"px",b.height=a.controls.height+"px",b.background=c("tintcolor")("#"+a.controls.color,20),b.translateZ=a.controls.depth/2;break;case 1:b.width=a.controls.width+"px",b.height=a.controls.height+"px",b.background=c("tintcolor")("#"+a.controls.color,20),b.rotateX=-180,b.rotateZ=180,b.translateZ=a.controls.depth/2;break;case 2:b.left=(a.controls.width-a.controls.depth)/2+"px",b.width=a.controls.depth+"px",b.height=a.controls.height+"px",b.background=c("tintcolor")("#"+a.controls.color,-20),b.rotateY=90,b.translateZ=a.controls.width/2;break;case 3:b.left=(a.controls.width-a.controls.depth)/2+"px",b.width=a.controls.depth+"px",b.height=a.controls.height+"px",b.background=c("tintcolor")("#"+a.controls.color,-20),b.rotateY=-90,b.translateZ=a.controls.width/2;break;case 4:b.top=(a.controls.height-a.controls.depth)/2+"px",b.height=a.controls.depth+"px",b.rotateX=90,b.translateZ=a.controls.height/2;break;case 5:b.bottom=(a.controls.height-a.controls.depth)/2+"px",b.height=a.controls.depth+"px",b.rotateX=-90,b.translateZ=a.controls.height/2}}a.style={position:"absolute",top:b.top,left:b.left,bottom:b.bottom,width:b.width,height:b.height,background:b.background,webkitTransform:"rotateX("+b.rotateX+"deg) rotateY("+b.rotateY+"deg) rotateZ("+b.rotateZ+"deg) translate3d("+b.translateX+"px, "+b.translateY+"px, "+b.translateZ+"px)"}}}}}).directive("makeShape",function(){return{restrict:"E",scope:{shape:"=shape",controls:"=controls",select:"&"},transclude:!0,replace:!1,template:"<div ng-style = 'style' ng-click = 'select(shape);'><make-shape-side index = '$index' shape = 'shape' controls = 'controls' ng-repeat = 'side in sides'></make-shape-side></div>",controller:function(a){a.$watchGroup(["controls.width","controls.height","controls.perspective.x","controls.perspective.y","controls.perspective.z"],function(){b()});var b=function(){var b=0;switch(a.controls.type){case"r":b=6}a.sides=[];for(var c=0;b>c;c++)a.sides.push(c);a.style={transformStyle:"preserve-3d",position:"absolute",left:"50%",top:"50%",marginTop:-a.controls.height/2+"px",marginLeft:-a.controls.width/2+"px",width:a.controls.width+"px",height:a.controls.height+"px",webkitTransform:"rotateX("+a.controls.perspective.x+"deg) rotateY("+a.controls.perspective.y+"deg) rotateZ("+a.controls.perspective.z+"deg)"}}}}}).factory("Shape",[function(){var a=function(a,b,c,d,e,f){this.id=a,this.type=b,this.width=c,this.depth=d,this.height=e,this.color=f};return a.prototype={},a}]).filter("tintcolor",function(){return function(a,b){var c=parseInt(a.substring(1,3),16),d=parseInt(a.substring(3,5),16),e=parseInt(a.substring(5,7),16);c=parseInt(c*(100+b)/100),d=parseInt(d*(100+b)/100),e=parseInt(e*(100+b)/100),c=255>c?c:255,d=255>d?d:255,e=255>e?e:255;var f=1==c.toString(16).length?"0"+c.toString(16):c.toString(16),g=1==d.toString(16).length?"0"+d.toString(16):d.toString(16),h=1==e.toString(16).length?"0"+e.toString(16):e.toString(16);return"#"+f+g+h}});